{"Timestamp":"2021-09-01T11:44:12.3623318-04:00","Level":"Information","MessageTemplate":"Refreshed TokenBlacklistCache","Properties":{"SourceContext":"API.Jobs.BackgroundTokenBlacklistSynchronizer"}}
{"Timestamp":"2021-09-01T11:44:18.8123923-04:00","Level":"Information","MessageTemplate":"{HostingRequestStartingLog:l}","Properties":{"Protocol":"HTTP/1.1","Method":"POST","ContentType":"application/json;charset=UTF-8","ContentLength":2238,"Scheme":"http","Host":"10.95.46.180:5001","PathBase":"","Path":"/api/cohort/count","QueryString":"","HostingRequestStartingLog":"Request starting HTTP/1.1 POST http://10.95.46.180:5001/api/cohort/count application/json;charset=UTF-8 2238","EventId":{"Id":1},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH"},"Renderings":{"HostingRequestStartingLog":[{"Format":"l","Rendering":"Request starting HTTP/1.1 POST http://10.95.46.180:5001/api/cohort/count application/json;charset=UTF-8 2238"}]}}
{"Timestamp":"2021-09-01T11:44:18.8126643-04:00","Level":"Information","MessageTemplate":"CORS policy execution successful.","Properties":{"EventId":{"Id":4,"Name":"PolicySuccess"},"SourceContext":"Microsoft.AspNetCore.Cors.Infrastructure.CorsService","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH"}}
{"Timestamp":"2021-09-01T11:44:18.8134671-04:00","Level":"Information","MessageTemplate":"Successfully validated the token.","Properties":{"EventId":{"Id":2,"Name":"TokenValidationSucceeded"},"SourceContext":"Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH"}}
{"Timestamp":"2021-09-01T11:44:18.8137618-04:00","Level":"Information","MessageTemplate":"Route matched with {RouteData}. Executing controller action with signature {MethodInfo} on controller {Controller} ({AssemblyName}).","Properties":{"RouteData":"{action = \"Count\", controller = \"CohortCount\"}","MethodInfo":"System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[API.DTO.Cohort.CohortCountDTO]] Count(API.DTO.Cohort.PatientCountQueryDTO, Model.Cohort.CohortCounter, System.Threading.CancellationToken)","Controller":"API.Controllers.CohortCountController","AssemblyName":"API","EventId":{"Id":3,"Name":"ControllerActionExecuting"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:18.8139506-04:00","Level":"Information","MessageTemplate":"Authorization was successful.","Properties":{"EventId":{"Id":1,"Name":"UserAuthorizationSucceeded"},"SourceContext":"Microsoft.AspNetCore.Authorization.DefaultAuthorizationService","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:18.8156496-04:00","Level":"Information","MessageTemplate":"FullCount starting. DTO:{@DTO}","Properties":{"DTO":{"_typeTag":"PatientCountQueryDTO","QueryId":"","Panels":[{"_typeTag":"PanelDTO","Id":"RAUfr-ZyBEi","SubPanels":[{"_typeTag":"SubPanelDTO","Id":"ViY8KiLbe3d","PanelItems":[{"_typeTag":"PanelItemDTO","Id":"lUKO_72iG","Resource":{"_typeTag":"ResourceRef","Id":"162e0859-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null,"UiDisplayName":"Age"},"Specializations":[],"NumericFilter":{"_typeTag":"NumericFilter","FilterType":"GreaterThanOrEqualTo","Filter":[89]},"RecencyFilter":"None","Index":0,"SubPanelIndex":0,"PanelIndex":0}],"PanelIndex":0,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}},{"_typeTag":"SubPanelDTO","Id":"yW4av3cjgg","PanelItems":[],"PanelIndex":0,"Index":1,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":0},{"_typeTag":"PanelDTO","Id":"P4afIJ9a899","SubPanels":[{"_typeTag":"SubPanelDTO","Id":"nXZo__zSI4-","PanelItems":[{"_typeTag":"PanelItemDTO","Id":"EAa6S8ssr","Resource":{"_typeTag":"ResourceRef","Id":"90f2b965-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null,"UiDisplayName":"Vesicoureteral-reflux, unspecified (ICD10CM:N13.70)"},"Specializations":[],"NumericFilter":{"_typeTag":"NumericFilter","FilterType":"None","Filter":[]},"RecencyFilter":"None","Index":0,"SubPanelIndex":0,"PanelIndex":0}],"PanelIndex":1,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}},{"_typeTag":"SubPanelDTO","Id":"oDZVvGwuGT","PanelItems":[],"PanelIndex":1,"Index":1,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":1},{"_typeTag":"PanelDTO","Id":"wqvzDa3Uyk6","SubPanels":[{"_typeTag":"SubPanelDTO","Id":"2m3jadHrTN0","PanelItems":[],"PanelIndex":2,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":2}],"PanelFilters":[]},"SourceContext":"Model.Cohort.CohortCounter","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:18.8162896-04:00","Level":"Information","MessageTemplate":"Getting preflight resources check. Refs:{@Refs}","Properties":{"Refs":{"_typeTag":"ResourceRefs","Concepts":[{"_typeTag":"ConceptRef","Id":"162e0859-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null},{"_typeTag":"ConceptRef","Id":"90f2b965-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null}],"Queries":[],"Imports":[]},"SourceContext":"Model.Search.PreflightResourceChecker","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:18.8318456-04:00","Level":"Information","MessageTemplate":"FullCount panel validation context. Context:{@Context}","Properties":{"Context":{"_typeTag":"PanelValidationContext","QueryId":null,"UniversalId":null,"PreflightCheck":{"_typeTag":"PreflightResources","Ok":true,"DirectConceptsCheck":{"_typeTag":"PreflightConcepts","PreflightCheck":{"_typeTag":"ConceptPreflightCheck","Ok":true,"Results":[{"_typeTag":"ConceptPreflightCheckResult","Id":"162e0859-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null,"IsPresent":true,"IsAuthorized":true},{"_typeTag":"ConceptPreflightCheckResult","Id":"90f2b965-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null,"IsPresent":true,"IsAuthorized":true}],"IsPresent":true,"IsAuthorized":true},"Concepts":[{"_typeTag":"Concept","ParentId":"132e0859-ae0a-ec11-9c22-000c29db1cc8","RootId":"132e0859-ae0a-ec11-9c22-000c29db1cc8","ExternalId":"demographics:age","ExternalParentId":"demographics","IsNumeric":true,"IsEventBased":false,"IsParent":false,"IsEncounterBased":false,"IsPatientCountAutoCalculated":false,"IsSpecializable":false,"SqlSetFrom":"(SELECT [person_id] = CONVERT(NVARCHAR(64), [person_id], 2),
                             [gender_concept_id],
                             [year_of_birth],
                             [month_of_birth],
                             [day_of_birth],
                             [birth_datetime],
                             [race_concept_id],
                             [ethnicity_concept_id],
                             [location_id],
                             [provider_id],
                             [care_site_id],
                             [person_source_value],
                             [gender_source_value],
                             [gender_source_concept_id],
                             [race_source_value],
                             [race_source_concept_id],
                             [ethnicity_source_value],
                             [ethnicity_source_concept_id]
                      FROM omop.cdm_deid_std.person)","SqlSetWhere":null,"SqlFieldDate":null,"SqlFieldNumeric":"/* Current Age */ (DATEDIFF(DAY, @.birth_datetime, GETDATE()) / 365.25)",
    "SqlFieldEvent":null,"UiDisplayName":"Age","UiDisplayText":"Are","UiDisplaySubtext":null,"UiDisplayUnits":"years old","UiDisplayTooltip":null,"UiDisplayEventName":null,"UiDisplayPatientCount":10105228,"EventTypeId":null,"SpecializationGroups":[],"UiDisplayPatientCountByYear":null,"UiNumericDefaultText":"any current age","Id":"162e0859-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null},{"_typeTag":"Concept","ParentId":"09997468-ae0a-ec11-9c22-000c29db1cc8","RootId":"a9946868-ae0a-ec11-9c22-000c29db1cc8","ExternalId":"UMLS_AUI:A17789622","ExternalParentId":"UMLS_AUI:A17815358","IsNumeric":false,"IsEventBased":false,"IsParent":false,"IsEncounterBased":true,"IsPatientCountAutoCalculated":true,"IsSpecializable":false,"SqlSetFrom":"rpt.test_omop_conditions.condition_occurrence","SqlSetWhere":"EXISTS
                               (SELECT 1
                                FROM
                                    omop.cdm_deid.concept AS @C_ICD10CM,
                                    omop.cdm_deid.concept_relationship AS @CR,
                                    omop.cdm_deid.concept AS @C_SNOMED
                                WHERE
                                    @C_ICD10CM.vocabulary_id = 'ICD10CM'
                                    AND @C_ICD10CM.concept_id = @CR.concept_id_1
                                    AND @CR.relationship_id = 'Maps to'
                                    AND @C_SNOMED.vocabulary_id = 'SNOMED'
                                    AND @C_SNOMED.concept_id = @CR.concept_id_2
                                    AND @.condition_concept_id = @C_SNOMED.concept_id
                                    AND @C_ICD10CM.concept_code = 'N13.70')",
    "SqlFieldDate":"@.condition_start_datetime","SqlFieldNumeric":null,"SqlFieldEvent":null,"UiDisplayName":"Vesicoureteral-reflux, unspecified (ICD10CM:N13.70)","UiDisplayText":"Had diagnosis of Vesicoureteral-reflux, unspecified (ICD10CM:N13.70)","UiDisplaySubtext":null,"UiDisplayUnits":null,"UiDisplayTooltip":null,"UiDisplayEventName":null,"UiDisplayPatientCount":null,"EventTypeId":null,"SpecializationGroups":[],"UiDisplayPatientCountByYear":null,"UiNumericDefaultText":null,"Id":"90f2b965-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null}],"IsPresent":true,"IsAuthorized":true,"Ok":true},"DirectQueriesCheck":{"_typeTag":"PreflightQueries","Ok":true,"Results":[]},"DirectImportsCheck":{"_typeTag":"PreflightImports","Ok":true,"Results":[]},"GlobalPanelFilters":[]},"Requested":[{"_typeTag":"PanelDTO","Id":"RAUfr-ZyBEi","SubPanels":[{"_typeTag":"SubPanelDTO","Id":"ViY8KiLbe3d","PanelItems":[{"_typeTag":"PanelItemDTO","Id":"lUKO_72iG","Resource":{"_typeTag":"ResourceRef","Id":"162e0859-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null,"UiDisplayName":"Age"},"Specializations":[],"NumericFilter":{"_typeTag":"NumericFilter","FilterType":"GreaterThanOrEqualTo","Filter":[89]},"RecencyFilter":"None","Index":0,"SubPanelIndex":0,"PanelIndex":0}],"PanelIndex":0,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}},{"_typeTag":"SubPanelDTO","Id":"yW4av3cjgg","PanelItems":[],"PanelIndex":0,"Index":1,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":0},{"_typeTag":"PanelDTO","Id":"P4afIJ9a899","SubPanels":[{"_typeTag":"SubPanelDTO","Id":"nXZo__zSI4-","PanelItems":[{"_typeTag":"PanelItemDTO","Id":"EAa6S8ssr","Resource":{"_typeTag":"ResourceRef","Id":"90f2b965-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null,"UiDisplayName":"Vesicoureteral-reflux, unspecified (ICD10CM:N13.70)"},"Specializations":[],"NumericFilter":{"_typeTag":"NumericFilter","FilterType":"None","Filter":[]},"RecencyFilter":"None","Index":0,"SubPanelIndex":0,"PanelIndex":0}],"PanelIndex":1,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}},{"_typeTag":"SubPanelDTO","Id":"oDZVvGwuGT","PanelItems":[],"PanelIndex":1,"Index":1,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":1},{"_typeTag":"PanelDTO","Id":"wqvzDa3Uyk6","SubPanels":[{"_typeTag":"SubPanelDTO","Id":"2m3jadHrTN0","PanelItems":[],"PanelIndex":2,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":2}],"Allowed":[{"_typeTag":"Panel","SubPanels":[{"_typeTag":"SubPanel","PanelItems":[{"_typeTag":"PanelItem","Concept":{"_typeTag":"Concept","ParentId":"132e0859-ae0a-ec11-9c22-000c29db1cc8","RootId":"132e0859-ae0a-ec11-9c22-000c29db1cc8","ExternalId":"demographics:age","ExternalParentId":"demographics","IsNumeric":true,"IsEventBased":false,"IsParent":false,"IsEncounterBased":false,"IsPatientCountAutoCalculated":false,"IsSpecializable":false,"SqlSetFrom":"(SELECT [person_id] = CONVERT(NVARCHAR(64), [person_id], 2),
                             [gender_concept_id],
                             [year_of_birth],
                             [month_of_birth],
                             [day_of_birth],
                             [birth_datetime],
                             [race_concept_id],
                             [ethnicity_concept_id],
                             [location_id],
                             [provider_id],
                             [care_site_id],
                             [person_source_value],
                             [gender_source_value],
                             [gender_source_concept_id],
                             [race_source_value],
                             [race_source_concept_id],
                             [ethnicity_source_value],
                             [ethnicity_source_concept_id]
                      FROM omop.cdm_deid_std.person)","SqlSetWhere":null,"SqlFieldDate":null,"SqlFieldNumeric":"/* Current Age */ (DATEDIFF(DAY, @.birth_datetime, GETDATE()) / 365.25)","SqlFieldEvent":null,"UiDisplayName":"Age","UiDisplayText":"Are","UiDisplaySubtext":null,"UiDisplayUnits":"years old","UiDisplayTooltip":null,"UiDisplayEventName":null,"UiDisplayPatientCount":10105228,"EventTypeId":null,"SpecializationGroups":[],"UiDisplayPatientCountByYear":null,"UiNumericDefaultText":"any current age","Id":"162e0859-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null},"Specializations":[],"SqlRecencyFilter":null,"UseNumericFilter":true,"HasSpecializations":false,"UseRecencyFilter":false,"NumericFilter":{"_typeTag":"NumericFilter","FilterType":"GreaterThanOrEqualTo","Filter":[89]},"RecencyFilter":"None","Index":0,"SubPanelIndex":0,"PanelIndex":0}],"HasCountFilter":false,"PanelIndex":0,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}},{"_typeTag":"SubPanel","PanelItems":[],"HasCountFilter":false,"PanelIndex":0,"Index":1,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"PanelType":"Sequence","IsDateFiltered":false,"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":0},{"_typeTag":"Panel","SubPanels":[{"_typeTag":"SubPanel","PanelItems":[{"_typeTag":"PanelItem","Concept":{"_typeTag":"Concept","ParentId":"09997468-ae0a-ec11-9c22-000c29db1cc8","RootId":"a9946868-ae0a-ec11-9c22-000c29db1cc8","ExternalId":"UMLS_AUI:A17789622","ExternalParentId":"UMLS_AUI:A17815358","IsNumeric":false,"IsEventBased":false,"IsParent":false,"IsEncounterBased":true,"IsPatientCountAutoCalculated":true,"IsSpecializable":false,"SqlSetFrom":"rpt.test_omop_conditions.condition_occurrence","SqlSetWhere":"EXISTS
                               (SELECT 1
                                FROM
                                    omop.cdm_deid.concept AS @C_ICD10CM,
                                    omop.cdm_deid.concept_relationship AS @CR,
                                    omop.cdm_deid.concept AS @C_SNOMED
                                WHERE
                                    @C_ICD10CM.vocabulary_id = 'ICD10CM'
                                    AND @C_ICD10CM.concept_id = @CR.concept_id_1
                                    AND @CR.relationship_id = 'Maps to'
                                    AND @C_SNOMED.vocabulary_id = 'SNOMED'
                                    AND @C_SNOMED.concept_id = @CR.concept_id_2
                                    AND @.condition_concept_id = @C_SNOMED.concept_id
                                    AND @C_ICD10CM.concept_code = 'N13.70')","SqlFieldDate":"@.condition_start_datetime","SqlFieldNumeric":null,"SqlFieldEvent":null,"UiDisplayName":"Vesicoureteral-reflux, unspecified (ICD10CM:N13.70)","UiDisplayText":"Had diagnosis of Vesicoureteral-reflux, unspecified (ICD10CM:N13.70)","UiDisplaySubtext":null,"UiDisplayUnits":null,"UiDisplayTooltip":null,"UiDisplayEventName":null,"UiDisplayPatientCount":null,"EventTypeId":null,"SpecializationGroups":[],"UiDisplayPatientCountByYear":null,"UiNumericDefaultText":null,"Id":"90f2b965-ae0a-ec11-9c22-000c29db1cc8","UniversalId":null},"Specializations":[],"SqlRecencyFilter":null,"UseNumericFilter":false,"HasSpecializations":false,"UseRecencyFilter":false,"NumericFilter":{"_typeTag":"NumericFilter","FilterType":"None","Filter":[]},"RecencyFilter":"None","Index":0,"SubPanelIndex":0,"PanelIndex":0}],"HasCountFilter":false,"PanelIndex":1,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}},{"_typeTag":"SubPanel","PanelItems":[],"HasCountFilter":false,"PanelIndex":1,"Index":1,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"PanelType":"Sequence","IsDateFiltered":false,"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":1},{"_typeTag":"Panel","SubPanels":[{"_typeTag":"SubPanel","PanelItems":[],"HasCountFilter":false,"PanelIndex":2,"Index":0,"IncludeSubPanel":true,"MinimumCount":1,"JoinSequence":{"_typeTag":"SubPanelJoinSequence","Increment":1,"DateIncrementType":"Day","SequenceType":"Encounter"},"DateFilter":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":0,"DateIncrementType":"None"}}],"PanelType":"Patient","IsDateFiltered":false,"DateFilter":{"_typeTag":"DateBoundary","Start":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"},"End":{"_typeTag":"DateFilter","Date":"0001-01-01T00:00:00.0000000","Increment":1,"DateIncrementType":"None"}},"IncludePanel":true,"Domain":"Panel","Index":2}],"PreflightPassed":true},"SourceContext":"Model.Cohort.CohortCounter","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:18.8328730-04:00","Level":"Information","MessageTemplate":"FullCount cohort started.","Properties":{"SourceContext":"Model.Cohort.CohortCounter","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:18.8332413-04:00","Level":"Information","MessageTemplate":"CTE SqlStatement:{Sql}","Properties":{"Sql":"
DECLARE @IsIdentified BIT = 0;
DECLARE @IsResearch   BIT = 0;
DECLARE @IsQI         BIT = 1;
WITH wrapper (personId) AS 
( SELECT P1.person_id FROM 
( SELECT  _S100.person_id
FROM rpt.test_omop_conditions.condition_occurrence AS _S100
WHERE EXISTS
       (SELECT 1
        FROM
            omop.cdm_deid.concept AS _S100C_ICD10CM,
            omop.cdm_deid.concept_relationship AS _S100CR,
            omop.cdm_deid.concept AS _S100C_SNOMED
        WHERE
            _S100C_ICD10CM.vocabulary_id = 'ICD10CM'
            AND _S100C_ICD10CM.concept_id = _S100CR.concept_id_1
            AND _S100CR.relationship_id = 'Maps to'
            AND _S100C_SNOMED.vocabulary_id = 'SNOMED'
            AND _S100C_SNOMED.concept_id = _S100CR.concept_id_2
            AND _S100.condition_concept_id = _S100C_SNOMED.concept_id
            AND _S100C_ICD10CM.concept_code = 'N13.70')
    GROUP BY _S100.person_id ) AS P1
    INTERSECT
    SELECT P0.person_id
    FROM ( SELECT  _S000.person_id FROM (
        SELECT [person_id] = CONVERT(NVARCHAR(64), [person_id], 2),
            [gender_concept_id],
            [year_of_birth],
            [month_of_birth],
            [day_of_birth],
            [birth_datetime],
            [race_concept_id],
            [ethnicity_concept_id],
            [location_id],
            [provider_id],
            [care_site_id],
            [person_source_value],
            [gender_source_value],
            [gender_source_concept_id],
            [race_source_value],
            [race_source_concept_id],
            [ethnicity_source_value],
            [ethnicity_source_concept_id]
    FROM omop.cdm_deid_std.person) AS _S000
    WHERE /* Current Age */ (DATEDIFF(DAY, _S000.birth_datetime, GETDATE()) / 365.25) >= 89 ) AS P0 )
SELECT personId FROM wrapper"
    ,"SourceContext":"Model.Cohort.PatientCohortService","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:29.1259447-04:00","Level":"Error","MessageTemplate":"Failed to execute query. Error:{Error}","Properties":{"Error":"System.Data.SqlClient.SqlException (0x80131904): Error converting data type nvarchar to bigint.
      at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
      at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
      at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
      at System.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
      at System.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
      at System.Data.SqlClient.SqlDataReader.Read()
      at Services.Cohort.CtePatientCohortService.GetPatientSetAsync(ISqlStatement query, CancellationToken token) in /var/opt/leafapi/leaf_download/leaf/src/server/Services/Cohort/CtePatientCohortService.cs:line 54
      at Services.Cohort.CtePatientCohortService.GetCohortAsync(PatientCountQuery query, CancellationToken token) in /var/opt/leafapi/leaf_download/leaf/src/server/Services/Cohort/CtePatientCohortService.cs:line 39
      at Model.Cohort.PatientCohortService.GetPatientCohortAsync(PatientCountQuery query, CancellationToken token) in /var/opt/leafapi/leaf_download/leaf/src/server/Model/Cohort/PatientCohortService.cs:line 38
      at Model.Cohort.CohortCounter.FullCount(IPatientCountQueryDTO queryDTO, CancellationToken token) in /var/opt/leafapi/leaf_download/leaf/src/server/Model/Cohort/CohortCounter.cs:line 202
      at Model.Cohort.CohortCounter.Count(IPatientCountQueryDTO queryDTO, CancellationToken token) in /var/opt/leafapi/leaf_download/leaf/src/server/Model/Cohort/CohortCounter.cs:line 91
      at API.Controllers.CohortCountController.Count(PatientCountQueryDTO patientCountQuery, CohortCounter counter, CancellationToken cancelToken) in /var/opt/leafapi/leaf_download/leaf/src/server/API/Controllers/CohortCountController.cs:line 73\nClientConnectionId:191be10f-8ab6-4e39-ad21-c98c882a12ce\nError Number:8114,State:5,Class:16","SourceContext":"API.Controllers.CohortCountController","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:29.1264936-04:00","Level":"Information","MessageTemplate":"Executing HttpStatusCodeResult, setting HTTP status code {StatusCode}","Properties":{"StatusCode":500,"EventId":{"Id":1,"Name":"HttpStatusCodeResultExecuting"},"SourceContext":"Microsoft.AspNetCore.Mvc.StatusCodeResult","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","ActionName":"API.Controllers.CohortCountController.Count (API)","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:29.1266780-04:00","Level":"Information","MessageTemplate":"Executed action {ActionName} in {ElapsedMilliseconds}ms","Properties":{"ActionName":"API.Controllers.CohortCountController.Count (API)","ElapsedMilliseconds":10312.7738,"EventId":{"Id":2,"Name":"ActionExecuted"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker","ActionId":"0460fa9e-292c-4cc9-a286-e7358700dd12","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH","SessionId":"94c780c4-519c-46ea-a759-0a8c9fa4986d","User":"arthur.p.goldberg@mssm.edu@urn:leaf:issuer:leaf.mssm.edu"}}
{"Timestamp":"2021-09-01T11:44:29.1268935-04:00","Level":"Information","MessageTemplate":"{HostingRequestFinishedLog:l}","Properties":{"ElapsedMilliseconds":10314.5453,"StatusCode":500,"ContentType":null,"HostingRequestFinishedLog":"Request finished in 10314.5453ms 500 ","EventId":{"Id":2},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HMB9ER01CNLH:00000003","RequestPath":"/api/cohort/count","SpanId":"|eacbf826-417cea76f0199663.","TraceId":"eacbf826-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLH"},"Renderings":{"HostingRequestFinishedLog":[{"Format":"l","Rendering":"Request finished in 10314.5453ms 500 "}]}}
{"Timestamp":"2021-09-01T11:44:42.3647654-04:00","Level":"Information","MessageTemplate":"Refreshed TokenBlacklistCache","Properties":{"SourceContext":"API.Jobs.BackgroundTokenBlacklistSynchronizer"}}
{"Timestamp":"2021-09-01T11:45:06.0751366-04:00","Level":"Information","MessageTemplate":"{HostingRequestStartingLog:l}","Properties":{"Protocol":"HTTP/1.1","Method":"GET","ContentType":null,"ContentLength":null,"Scheme":"http","Host":"10.95.46.180:5001","PathBase":"","Path":"/api/user/refresh","QueryString":"","HostingRequestStartingLog":"Request starting HTTP/1.1 GET http://10.95.46.180:5001/api/user/refresh  ","EventId":{"Id":1},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HMB9ER01CNLI:00000002","RequestPath":"/api/user/refresh","SpanId":"|eacbf827-417cea76f0199663.","TraceId":"eacbf827-417cea76f0199663","ParentId":"","ConnectionId":"0HMB9ER01CNLI"},"Renderings":{"HostingRequestStartingLog":[{"Format":"l","Rendering":"Request starting HTTP/1.1 GET http://10.95.46.180:5001/api/user/refresh  "}]}}
